<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>t3n28-bot — Poisson Football Predictor</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
<div class="wrap">
  <header>
    <h1>⚽ t3n28-bot — Football Predictor</h1>
  </header>

  <div class="controls card">
    <label>Home Team</label><input id="homeTeam" placeholder="Home team name">
    <label>Away Team</label><input id="awayTeam" placeholder="Away team name">
    <button id="predictBtn" class="btn">Predict</button>
  </div>

  <main id="mainArea" class="card">
    <div id="placeholder" class="meta">Enter teams and click Predict.</div>
  </main>
</div>

<script>
const el=id=>document.getElementById(id);

function setPlaceholder(txt){ el('placeholder').textContent=txt; }

function renderPrediction(data){
  const main=el('mainArea');
  main.innerHTML='';
  const card=document.createElement('div'); card.className='card game';
  const rec=document.createElement('div'); rec.className='rec'; rec.textContent='Recommendation: '+data.recommendation;
  const conf=document.createElement('div'); conf.className='confidence';
  const p=data.probabilities;
  const maxP=Math.max(p.home,p.draw,p.away)*100;
  conf.textContent=`Confidence: ${Math.round(maxP)}%`;

  const barWrap=document.createElement('div'); barWrap.className='prob-bar';
  ['home','draw','away'].forEach(k=>{
    const d=document.createElement('div');
    d.className='prob-'+k;
    d.style.width=Math.round((p[k]||0)*100)+'%';
    barWrap.appendChild(d);
  });

  card.appendChild(rec);
  card.appendChild(conf);
  card.appendChild(barWrap);
  main.appendChild(card);
}

el('predictBtn').addEventListener('click',async()=>{
  const home=el('homeTeam').value.trim();
  const away=el('awayTeam').value.trim();
  if(!home||!away){ alert('Enter both teams'); return; }
  setPlaceholder('Predicting...');
  try{
    const res=await fetch('/api/predict',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({fixture:{home_team:home,away_team:away}, options:{}})
    });
    const data=await res.json();
    renderPrediction(data);
  }catch(e){ console.error(e); setPlaceholder('Prediction failed'); }
});
</script>
</body>
</html>
